<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ima Made Nando Mo by The Mass Missile | Creative Coding</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+1p:500,900" rel="stylesheet">    <link rel="stylesheet" href="css/style.css">
    <script src="vendors/audioLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.2/TweenMax.min.js"></script>
    <script src="js/class.js"></script>
</head>

<body>
    <div id="cache"></div>
    <div id="intro">
        <div class="title">
            <i class="fas fa-headphones headphones"></i>
            <h1>IMA MADE NANDO MO</h1>
            <h2>THE MASS MISSILE</h2>
        </div>
        <div class="info">
            <p>Press F11 to go full screen</p>
            <p>And don't foreget your headphones <i class="far fa-smile-wink"></i></p>
        </div>
    </div>
    <div id="info">Click anywhere to change lyrics language</div>
    <div id="lyrics-jp" class="lyrics">
        <section>
            <span>我<span>ガ</span></span>
            <span>慢<span>まん</span></span>
            の
            <span>連<span>れん</span></span>
            <span>続<span>ぞく</span></span>
            だったろ
        </section>
        <section>
            <span>心<span class="threeKana">こころ</span></span>
            で
            <span>泣<span>な</span></span>
            いていたんだろ
        </section>
        <section>
            <span>自<span>じ</span></span>
            <span>分<span>ぶん</span></span>
            で
            <span>決<span>き</span></span>
            めたその
            <span>夢<span>ゆめ</span></span>
            だけは</section>
        <section>ゆずれないんだろ？</section>

        <section>
            <span>苦<span>くる</span></span>
            しんだ
            <span>数<span>かず</span></span>
            なんかより</section>
        <section>
            <span>疑<span class="fourKana">うたがう</span></span>
            った
            <span>数<span>かず</span></span>
            なんかより</section>
        <section>
            <span>笑<span class="threeKana">わらう</span></span>
            った
            <span>数<span>かず</span></span>
            や
            <span>信<span>しん</span></span>
            じた
            <span>数<span>かず</span></span>
            が</section>
        <section>
            <span>少<span>すこ</span></span>
            しだけ
            <span>多<span>おお</span></span>
            い
            <span>人<span>じん</span></span>
            <span>生<span>せい</span></span>
            だありますように</section>

        <section>
            <span>脇<span>わき</span></span>
            <span>役<span>やく</span></span>
            だけど</section>
        <section>
            かげの
            <span>人<span>ひと</span></span>
            だけど</section>
        <section>
            <span>夢<span>ゆめ</span></span>
            と</section>
        <section>
            <span>向<span>む</span></span>
            き
            <span>合<span>あ</span></span>
            う
            <span>時<span>とき</span></span>
            くらい</section>
        <section>
            <span>真<span>ま</span></span>
            ん
            <span>中<span>なか</span></span>
            にいさせて</section>
        <section>
            <span>正<span class="threeKana">しょう</span></span>
            <span>直<span>じき</span></span>
            にいさせて</section>

        <section>
            <span>今<span>いま</span></span>
            まで
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>
        <section>なんとかあきらめずに</section>
        <section>
                <span>今<span>いま</span></span>
                まで
                <span>何<span>なん</span></span>
                <span>度<span>ど</span></span>
                も</section>
        <section>
            <span>立<span>た</span></span>
            ち
            <span>上<span>あ</span></span>
            がってきたじゃないか</section>
        <section>
                <span>今<span>いま</span></span>
                まで
                <span>何<span>なん</span></span>
                <span>度<span>ど</span></span>
                も</section>
        <section>
            <span>僕<span>ぼく</span></span>
            ら</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span></section>
        <section>
            <span>信<span>しん</span></span>
            じて</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span></section>
        <section>
            <span>夢<span>ゆめ</span></span>
            <span>見<span>み</span></span>
            て</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span></section>

        <section>
                <span>今<span>いま</span></span>
                まで
                <span>何<span>なん</span></span>
                <span>度<span>ど</span></span>
                も</section>
        <section>
            バカを
            <span>見<span>みて</span></span>
            てきたじゃないか</section>
        <section>
                <span>今<span>いま</span></span>
                まで
                <span>何<span>なん</span></span>
                <span>度<span>ど</span></span>
                も</section>
        <section>
            <span>人<span>ひと</span></span>
            のかげに
            <span>立<span>た</span></span>
            ってきたじゃないか</section>
        <section>
            さぁ
            <span>主<span>しゅ</span></span>
            <span>役<span>やく</span></span>
            だよ</section>
        <section>
            <span>自<span>じ</span></span>
            <span>分<span>ぶん</span></span>
            の
            <span>夢<span>ゆめ</span></span>
            くらい</section>
        <section>わがままでいさせて</section>

        <section>いろんな</section>
        <section>ものから</section>
        <section>
            <span>逃<span>に</span></span>
            げ
            <span>出<span>げ</span></span>
            して</section>
        <section>
            その
            <span>決<span>けつ</span></span>
            <span>断<span>だん</span></span>
            を</section>
        <section>
            <span>先<span>さき</span></span>
            <span>送<span>おこ</span></span>
            りにした</section>
        <section>
            その
            <span>夢<span>ゆめ</span></span>
            だけは</section>
        <section>
            その
            <span>夢<span>ゆめ</span></span>
            だけは</section>

        <section>
            <span>脇<span>わき</span></span>
            <span>役<span>やく</span></span>
            なんて</section>
        <section>もうたくさんだ</section>
        <section>
            <span>夢<span>ゆめ</span></span>
            と</section>
        <section>
            <span>向<span>む</span></span>
            き
            <span>合<span>あ</span></span>
            う
            <span>時<span>とき</span></span>
            くらい</section>
        <section>
            <span>真<span>ま</span></span>
            ん中にいさせて</section>
        <section>
            <span>正<span class="threeKana">しょう</span></span>
            <span>直<span>じき</span></span>
            にいさせて</section>
        <section>
            <span>脇<span>わき</span></span>
            <span>役<span>やく</span></span>
            じゃなくって</section>
        <section>
            <span>主<span>しゅ</span></span>
            <span>役<span>やく</span></span>
            でいようぜ</section>

            <section>
                    <span>今<span>いま</span></span>
                    まで
                    <span>何<span>なん</span></span>
                    <span>度<span>ど</span></span>
                    も</section>
                <section>なんとかあきらめずに</section>
                <section>
                        <span>今<span>いま</span></span>
                        まで
                        <span>何<span>なん</span></span>
                        <span>度<span>ど</span></span>
                        も</section>
                <section>
                    <span>立<span>た</span></span>
                    ち
                    <span>上<span>あ</span></span>
                    がってきたじゃないか</section>
                <section>
                        <span>今<span>いま</span></span>
                        まで
                        <span>何<span>なん</span></span>
                        <span>度<span>ど</span></span>
                        も</section>
                <section>
                    <span>僕<span>ぼく</span></span>
                    ら</section>
                <section>
                    <span>何<span>なん</span></span>
                    <span>度<span>ど</span></span></section>
                <section>
                    <span>信<span>しん</span></span>
                    じて</section>
                <section>
                    <span>何<span>なん</span></span>
                    <span>度<span>ど</span></span></section>
                <section>
                    <span>夢<span>ゆめ</span></span>
                    <span>見<span>み</span></span>
                    て</section>
                <section>
                    <span>何<span>なん</span></span>
                    <span>度<span>ど</span></span>
                    も</section>

        <section>つらぬくために</section>
        <section>いろいろまげた</section>
        <section>
            <span>信<span>しん</span></span>
            じるために</section>
        <section>
            <span>疑<span class="fourKana">うたがう</span></span>
            ってきた</section>
        <section>
            <span>守<span>まも</span></span>
            ってくために</section>
        <section>
            <span>人<span>ひと</span></span>
            を
            <span>傷<span>きず</span></span>
            つけた</section>
        <section>
            <span>今<span>いま</span></span>
            まで
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>

        <section>
            <span>今<span>いま</span></span>
            まで
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>
        <section>
            バカを
            <span>見<span>いて</span></span>
            てきたじゃないか</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>
        <section>
            <span>人<span>ひと</span></span>
            のかげに
            <span>立<span>た</span></span>
            ってきたじゃないか </section>
        <section>さぁ
                <span>主<span>しゅ</span></span>
                <span>役<span>やく</span></span>
                だよ</section>
        <section>
            <span>自<span>じ</span></span>
            <span>分<span>ぶん</span></span>
            の
            <span>夢<span>ゆめ</span></span>
            くらい</section>
        <section>わがままでいさせて</section>

        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>
        <section>
            <span>今<span>いま</span></span>
            まで</section>
        <section>
            <span>何<span>なん</span></span>
            <span>度<span>ど</span></span>
            も</section>

    </div>
    <div id="lyrics-fr" class="lyrics">
        <section style="opacity: 0;">Gaman no renzoku dattaro</section>
        <section style="opacity: 0;">Kokoro de naiteita ndarou</section>
        <section style="opacity: 0;">Jibun de kimeta sono yume dake wa</section>
        <section style="opacity: 0;">Yuzurenai ndarou ? </section>

        <section style="opacity: 0;">Kurushi nda kazu nanka yori</section>
        <section style="opacity: 0;">Utagatta kazu nanka yori</section>
        <section style="opacity: 0;">Waratta kazu ya shinjita kazu ga</section>
        <section style="opacity: 0;">Sukoshi dake ooi jinsei de arimasu you ni</section>

        <section style="opacity: 0;">Wakiyaku dakedo</section>
        <section style="opacity: 0;">Kage no hito dakedo</section>
        <section style="opacity: 0;">Yume to</section>
        <section style="opacity: 0;">Mukiau toki kurai</section>
        <section style="opacity: 0;">Man naka ni isasete</section>
        <section style="opacity: 0;">Shoujiki ni isasete</section>

        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Nan toka akiramezu ni</section>
        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Tachi agatte kita janai ka</section>
        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Bokura</section>
        <section style="opacity: 0;">NANDO MO</section>
        <section style="opacity: 0;">Shinjite</section>
        <section style="opacity: 0;">NANDO MO</section>
        <section style="opacity: 0;">Yume mite</section>
        <section style="opacity: 0;">NANDO MO</section>

        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Baka o mite kita janai ka</section>
        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">hito no kage ni tatte kita janai ka</section>
        <section style="opacity: 0;">Saa shuyaku da yo</section>
        <section style="opacity: 0;">Jibun no yume kurai</section>
        <section style="opacity: 0;">Wagamama de isasete</section>

        <section style="opacity: 0;">Iron na</section>
        <section style="opacity: 0;">Mono kara</section>
        <section style="opacity: 0;">Nigedashite</section>
        <section style="opacity: 0;">Sono ketsudan o</section>
        <section style="opacity: 0;">Sakiokori ni shita</section>
        <section style="opacity: 0;">Sono yume dake wa</section>
        <section style="opacity: 0;">Sono yume dake wa</section>

        <section style="opacity: 0;">Wakiyaku nante</section>
        <section style="opacity: 0;">Mou takusan da</section>
        <section style="opacity: 0;">Yume to</section>
        <section style="opacity: 0;">Mukiau toki kurai</section>
        <section style="opacity: 0;">Man naka ni isasete</section>
        <section style="opacity: 0;">Shoujiki ni isasete</section>
        <section style="opacity: 0;">Wakiyaku janakutte</section>
        <section style="opacity: 0;">Shuyaku de iyouze</section>

        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Nan toka akiramezu ni</section>
        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Tachi agatte kita janai ka</section>
        <section style="opacity: 0;">IMA MADE NANDO MO</section>
        <section style="opacity: 0;">Bokura</section>
        <section style="opacity: 0;">NANDO MO</section>
        <section style="opacity: 0;">Shinjite</section>
        <section style="opacity: 0;">NANDO MO</section>
        <section style="opacity: 0;">Yume mite</section>
        <section style="opacity: 0;">NANDO MO</section>

        <section style="opacity: 0;">Tsuranuku tame ni</section>
        <section style="opacity: 0;">Iroiro mageta</section>
        <section style="opacity: 0;">Shinjiru tame ni</section>
        <section style="opacity: 0;">Utagatte kita</section>
        <section style="opacity: 0;">Mamotteku tame ni</section>
        <section style="opacity: 0;">Hito o kizutsuketa</section>
        <section style="opacity: 0;">Ima made nando mo</section>
        <section style="opacity: 0;">Nandomo</section>

        <section style="opacity: 0;">Ima made nando mo</section>
        <section style="opacity: 0;">Baka o mite kita janai ka</section>
        <section style="opacity: 0;">Nandomo</section>
        <section style="opacity: 0;">Hito no kage ni tatte kita janai ka</section>
        <section style="opacity: 0;">Saa shuyaku da yo</section>
        <section style="opacity: 0;">Jibun no yume kurai</section>
        <section style="opacity: 0;">Wagamama de isasete</section>

        <section style="opacity: 0;">Nando mo</section>
        <section style="opacity: 0;">Ima Made</section>
        <section style="opacity: 0;">Nando mo</section>

    </div>
    <div id="outro">
        <p>Song :</p>
        <h3>Ima Made Nando Mo by The Mass Missile</h3>
        <p>Designed and developed by :</p>
        <h3><a href="https://remi-rucojevic.com">Rémi Rucojevic</a></h3>
    </div>
    <canvas id="canvas"></canvas>
    

    <script>
        var canvas = document.getElementById("canvas")
        var ctx = canvas.getContext("2d")
        //Game prop
        var mouseX = 0
        var mouseY = 0
        var musicStarted = false
        var userClicked = false
        var circleStart

        //Polyfile
        window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext

        //Sound stuff
        var audioCtx = new AudioContext()
        var audioBuffer
        var audioSource
        var analyser = audioCtx.createAnalyser()
        var frequencyData = new Uint8Array(analyser.frequencyBinCount)

        function loadSound(url) {
            // Get the sound file
            var request = new XMLHttpRequest()
            request.open('GET', url, true)
            request.responseType = 'arraybuffer'

            // Progress
            var progressBar = new ProgressBar(canvas.height / 2)
            request.onprogress = (oEvent) => {
                var progress = oEvent.loaded / oEvent.total
                var progress = map(oEvent.loaded / oEvent.total, 0, 1, 0, canvas.width)
                progressBar.update(progress)
            }

            // Decode asynchronously
            request.onload = function () {
                

                audioCtx.decodeAudioData(request.response, function (buffer) {

                    // success callback
                    audioBuffer = buffer

                    // Create sound from buffer
                    audioSource = audioCtx.createBufferSource()
                    audioSource.buffer = audioBuffer

                    // connect the audio source to context's output
                    audioSource.connect(analyser)
                    analyser.connect(audioCtx.destination)

                    //addListener
                    document.getElementById("intro").style.display = "block"
                    requestAnimationFrame(game)
                    circleStart = new CircleStart()
                    document.addEventListener("click", play)
                    console.log("loaded")

                }, function () {

                    // error callback
                    //
                });
            }
            request.send()
        }

        function map(value, start1, stop1, start2, stop2) {
            return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
        }

        function easeInQuad(t, b, c, d) {
            return c*(t/=d)*t + b;
          }

          function easeInQuart(t, b, c, d) {
            return c*(t/=d)*t*t*t + b;
          }

        function play() {
            audioSource.start()
            TweenMax.to("#intro", 9.8, {opacity:0}, ()=>{
                document.getElementById("intro").style.display = "none"
            });
            musicStarted = true
            document.removeEventListener("click", play)
        }

        function resizeCanvas() {
            canvas.style.height = window.innerHeight + "px"
            canvas.height = window.innerHeight
            canvas.style.width = window.innerWidth + "px"
            canvas.width = window.innerWidth
        }

        var iColor = 0
        function updateColor(){
            iColor++
            if(iColor>(sphereColor.length-1)){
                iColor = 0
            }
            spheres.forEach(sphere =>{
                sphere.style = sphereColor[iColor]
            })
        }

        resizeCanvas()

        loadSound("audio/audio2.mp3")

        var now = Date.now()
        var last = now
        var deltaTime = 0
        var currentTimeSong = 0

        var baseBpm = 200
        var bpm = baseBpm
        var basseFreq = 0
        var hauteFreq = 0
        var inverse = false
        var inverseAnimationTime = 0
        var updateColorAnimationTime = 0

        var bg = new Background(canvas.height, canvas.width)
        var bgAnimationTime = 0
        var drawLine = false
        var drawLine2 = false

        let centerX = canvas.width/2
        let centerY = canvas.height/2
        let distanceX = 0
        let distanceY = 0
        let focalLength = 50
        var sphereVelocity = -6
        let starRadius = null
        let starX = null
        let starY = null
        let starX_dir = 0
        let starY_dir = 0

        let w = canvas.width
        let h = canvas.height
        if(w<1920){
            w = 1920
        }
        if(h<1080){
            h = 1080
        }

        let starsN = 500
        var stars = []
        for(let i = 0; i < starsN; i++){
            let sx = Math.random() * w
            let sy = Math.random() * h
            let velocityX = (Math.random()-0.5)/4
            let velocityY = (Math.random()-0.5)/4
            let radius = Math.random()

            let str = new Star(sx,sy,velocityX,velocityY, radius)
            stars.push(str)
        }

        let spheresN = 500
        let spheresNtoScreen = spheresN
        var spheres = []
        for(let i = 0; i < spheresN; i++){
            let sx = Math.random() * w
            let sy = Math.random() * h
            let sz = Math.random() * w
            let sph = new Sphere(sx,sy,sz)
            spheres.push(sph)
        }

        function game() {
            now = Date.now()
            deltaTime = now - last
            if(musicStarted){
                currentTimeSong += deltaTime/1000
            } else {
                currentTimeSong = 0
            }
            last = now

            analyser.getByteFrequencyData(frequencyData)

            for(let i = 0; i < 341; i++){
                basseFreq += frequencyData[i]
            }
            basseFreq /= 341
            basseFreq = map(basseFreq,0, 200,8,16)

            for(let i = 1024-341; i < 1024; i++){
                hauteFreq += frequencyData[i]
            }
            hauteFreq /= 341
            hauteFreq = map(basseFreq,0, 200,8,16)

            if(inverseAnimationTime > 60000/bpm){
                inverseAnimationTime = 0
                if(inverse){
                    inverse = false
                } else {
                    inverse = true
                }
            } else {
                inverseAnimationTime += deltaTime
            }

            if(updateColorAnimationTime > 60000/(bpm/2)){
                updateColorAnimationTime=0
                updateColor()
            } else {
                updateColorAnimationTime+=deltaTime
            }

            if(spheresNtoScreen > 500){
                spheresNtoScreen = 500
            }

            var bgP = map(currentTimeSong,0,276.141,canvas.height*5,100)
            bg.update(canvas.height, canvas.width, bgP)
            

            if (!musicStarted && circleStart != undefined) {
                circleStart.update(mouseX, mouseY, 50)
            } else if (musicStarted && bgAnimationTime < 9800) {
                bgAnimationTime += deltaTime
                circleStart.update(mouseX, mouseY, canvas.width / 2, bgAnimationTime)
            } else {
                bg.started = true
            }

            stars.forEach(star=>{
                star.update(distanceX, distanceY)
            })
            if(drawLine){
                for(let i=0; i<stars.length/2;i++){
                    for(let j = stars.length/2; j<stars.length;j++){
                        if(Math.sqrt( Math.pow((stars[j].x-stars[i].x),2) + Math.pow((stars[j].y-stars[i].y), 2))<50){
                            stars[i].lineTo(stars[j],map(frequencyData[100],130,200,0,0.8), distanceX, distanceY,0)
                            //"46, 171, 98"
                        }
                    }
                }
            }
            if(drawLine2){
                for(let i=0; i<stars.length/2;i++){
                    for(let j = stars.length/2; j<stars.length;j++){
                        var dist = Math.sqrt( Math.pow((stars[j].x-stars[i].x),2) + Math.pow((stars[j].y-stars[i].y), 2))
                        if(dist >= 50 && dist <100){
                            stars[i].lineTo(stars[j],map(frequencyData[500],130,200,0,0.8), distanceX, distanceY)
                        }
                    }
                }
            }

            if(currentTimeSong > 9.8){
                if(inverse){
                    for(let i=0; i<spheresNtoScreen/2; i++){
                        spheres[i].update(centerX, centerY, focalLength, 8, 1, sphereVelocity)
                    }
                    for(let i=parseInt(spheresNtoScreen/2); i<spheresNtoScreen; i++){
                        spheres[i].update(centerX, centerY, focalLength, 16, 1, sphereVelocity)
                    }
                } else {
                    for(let i=0; i<spheresNtoScreen/2; i++){
                        spheres[i].update(centerX, centerY, focalLength, 16,1, sphereVelocity)
                    }
                    for(let i=parseInt(spheresNtoScreen/2); i<spheresNtoScreen-1; i++){
                        spheres[i].update(centerX, centerY, focalLength, 8,1, sphereVelocity)
                    }
                }
            }

            /*
            *
            *
            Number of spheres
            *
            */


            if(currentTimeSong > 17.3 && currentTimeSong < 19.8){
                var d = 19.8-17.3
                spheresNtoScreen = easeInQuad(-(19.8-currentTimeSong-d), 500, -450, d);
            }

            if(currentTimeSong > 36.5 && currentTimeSong < 38.4){
                var d = 38.4-36.5
                spheresNtoScreen = easeInQuad(-(38.4-currentTimeSong-d), 50, 100, d);
            }

            if(currentTimeSong > 56.642 && currentTimeSong < 58.630){
                var d = 58.630-56.642
                spheresNtoScreen = easeInQuad(-(58.630-currentTimeSong-d), 150, 50, d);
            }
            

            if(currentTimeSong > 79.489 && currentTimeSong < 80.301){
                var d = 80.301-79.489
                spheresNtoScreen = easeInQuart(-(80.301-currentTimeSong-d), 200, 300, d);
            }

            if(currentTimeSong > 136.468 && currentTimeSong < 141.247){
                var d = 141.247-136.468
                spheresNtoScreen = easeInQuad(-(141.247-currentTimeSong-d), 500, -450, d);
            }
            if(currentTimeSong > 155.804 && currentTimeSong < 157.629){
                var d = 157.629-155.804
                spheresNtoScreen = easeInQuad(-(157.629-currentTimeSong-d), 50, 100, d);
            }
            if(currentTimeSong > 160.683 && currentTimeSong < 163.460){
                var d = 163.460-160.683
                spheresNtoScreen = easeInQuad(-(163.460-currentTimeSong-d), 150, 50, d);
            }
            if(currentTimeSong > 163.460 && currentTimeSong < 165.949){
                var d = 165.949-163.460
                spheresNtoScreen = 0
            }
            if(currentTimeSong > 165.949 && currentTimeSong < 167.497){
                var d = 167.497-165.949
                spheresNtoScreen = 200
            }
            if(currentTimeSong > 190.200 && currentTimeSong < 192.207){
                var d = 192.207-190.200
                spheresNtoScreen = easeInQuart(-(192.207-currentTimeSong-d), 200, 300, d);
            }
            if(currentTimeSong > 268.552 && currentTimeSong < 276.141){
                var d = 276.141-268.552
                spheresNtoScreen = easeInQuart(-(276.141-currentTimeSong-d), 500, -500, d);
            }

            /*
            *
            *
            Pauses
            *
            */
            sphereVelocity = -6

            //1
            if(currentTimeSong > 58.546 && currentTimeSong < 58.967){
                sphereVelocity = 2.5
            }
            if(currentTimeSong > 58.963 && currentTimeSong < 59.388){
                sphereVelocity = 2.5
            }
            if(currentTimeSong > 59.646 && currentTimeSong < 61.063){
                sphereVelocity = 2.5
            }

            //2
            if(currentTimeSong > 63.499 && currentTimeSong < 63.818){
                sphereVelocity = 2.5
            }
            if(currentTimeSong > 63.824 && currentTimeSong < 64.302){
                sphereVelocity = 2.5
            }
            if(currentTimeSong > 64.443 && currentTimeSong < 65.971){
                sphereVelocity = 2.5
            }

            //ref1
            if(currentTimeSong > 68.244 && currentTimeSong < 68.680){
                sphereVelocity = 0
            }
            if(currentTimeSong > 109.961 && currentTimeSong < 110.350){
                sphereVelocity = 0
            }
            if(currentTimeSong > 129.566 && currentTimeSong < 129.992){
                sphereVelocity = 0
            }

            //ref2
            if(currentTimeSong > 241.402 && currentTimeSong < 241.888){
                sphereVelocity = 0
            }
            /*if(currentTimeSong > 109.961 && currentTimeSong < 110.150){
                sphereVelocity = 0
            }
            if(currentTimeSong > 129.566 && currentTimeSong < 129.692){
                sphereVelocity = 0
            }*/

            //3
            if(currentTimeSong > 175.439 && currentTimeSong < 176.034){
                sphereVelocity = 0
            }

            /*
            *
            *
            Draw line
            *
            */
            drawLine2 = false

            if(currentTimeSong>38.4){
                drawLine = true
            }

            if(currentTimeSong>79.766 && currentTimeSong<119.551){
                drawLine2 = true
            }

            if(currentTimeSong>191.971 && currentTimeSong<268.453){
                drawLine2 = true
            }

            /*
            *
            *
            BPM
            *
            */
            bpm = baseBpm

            if(currentTimeSong>231.704 && currentTimeSong<241.878){
                bpm = 88
                sphereVelocity = -3
            }

            /*
            *
            *
            Display information
            *
            */

            if(currentTimeSong>18.405 && currentTimeSong<22.46){document.addEventListener("click", changeLyrics)}
            if(currentTimeSong>23.210 && currentTimeSong<33.210 && (!userClicked)){document.getElementById("info").classList.add("display")}else{document.getElementById("info").classList.remove("display")}

            /*
            *
            *
            Lyrics
            *
            */
            TweenMax.to("section",1,{opacity:0})
            if(currentTimeSong>18.405 && currentTimeSong<22.46){TweenMax.to("section:nth-child(1)",1,{opacity:1})}
            if(currentTimeSong>23.210 && currentTimeSong<27.477){TweenMax.to("section:nth-child(2)",1,{opacity:1})}
            if(currentTimeSong>28.083 && currentTimeSong<33.747){TweenMax.to("section:nth-child(3)",1,{opacity:1})}
            if(currentTimeSong>33.747 && currentTimeSong<36.917){ TweenMax.to("section:nth-child(4)",1,{opacity:1})}

            if(currentTimeSong>37.444 && currentTimeSong<42.494){ TweenMax.to("section:nth-child(5)",1,{opacity:1})}
            if(currentTimeSong>42.494 && currentTimeSong<47.498){ TweenMax.to("section:nth-child(6)",1,{opacity:1})}
            if(currentTimeSong>47.498 && currentTimeSong<53.345){ TweenMax.to("section:nth-child(7)",1,{opacity:1})}
            if(currentTimeSong>53.345 && currentTimeSong<58.827){ TweenMax.to("section:nth-child(8)",1,{opacity:1})}

            if(currentTimeSong>59.022 && currentTimeSong<61.634){ TweenMax.to("section:nth-child(9)",1,{opacity:1})}
            if(currentTimeSong>63.781 && currentTimeSong<67.569){ TweenMax.to("section:nth-child(10)",1,{opacity:1})}
            if(currentTimeSong>67.569 && currentTimeSong<69.244){ TweenMax.to("section:nth-child(11)",1,{opacity:1})}
            if(currentTimeSong>69.244 && currentTimeSong<72.775){ TweenMax.to("section:nth-child(12)",1,{opacity:1})}
            if(currentTimeSong>72.775 && currentTimeSong<75.329){ TweenMax.to("section:nth-child(13)",1,{opacity:1})}
            if(currentTimeSong>75.329 && currentTimeSong<78.449){ TweenMax.to("section:nth-child(14)",1,{opacity:1})}

            if(currentTimeSong>79.806 && currentTimeSong<82.027){ TweenMax.to("section:nth-child(15)",1,{opacity:1})}
            if(currentTimeSong>82.027 && currentTimeSong<84.944){ TweenMax.to("section:nth-child(16)",1,{opacity:1})}
            if(currentTimeSong>84.944 && currentTimeSong<86.946){ TweenMax.to("section:nth-child(17)",1,{opacity:1})}
            if(currentTimeSong>86.946 && currentTimeSong<89.802){ TweenMax.to("section:nth-child(18)",1,{opacity:1})}
            if(currentTimeSong>89.802 && currentTimeSong<91.659){ TweenMax.to("section:nth-child(19)",1,{opacity:1})}
            if(currentTimeSong>91.659 && currentTimeSong<92.738){ TweenMax.to("section:nth-child(20)",1,{opacity:1})}
            if(currentTimeSong>92.738 && currentTimeSong<94.204){ TweenMax.to("section:nth-child(21)",1,{opacity:1})}
            if(currentTimeSong>94.204 && currentTimeSong<95.162){ TweenMax.to("section:nth-child(22)",1,{opacity:1})}
            if(currentTimeSong>95.162 && currentTimeSong<96.307){ TweenMax.to("section:nth-child(23)",1,{opacity:1})}
            if(currentTimeSong>96.307 && currentTimeSong<97.627){ TweenMax.to("section:nth-child(24)",1,{opacity:1})}
            if(currentTimeSong>97.627 && currentTimeSong<99.253){ TweenMax.to("section:nth-child(25)",1,{opacity:1})}

            if(currentTimeSong>99.253 && currentTimeSong<101.705){ TweenMax.to("section:nth-child(26)",1,{opacity:1})}
            if(currentTimeSong>101.705 && currentTimeSong<104.579){ TweenMax.to("section:nth-child(27)",1,{opacity:1})}
            if(currentTimeSong>104.579 && currentTimeSong<106.538){ TweenMax.to("section:nth-child(28)",1,{opacity:1})}
            if(currentTimeSong>106.538 && currentTimeSong<110.079){ TweenMax.to("section:nth-child(29)",1,{opacity:1})}
            if(currentTimeSong>111.697 && currentTimeSong<113.975){ TweenMax.to("section:nth-child(30)",1,{opacity:1})}
            if(currentTimeSong>114.394 && currentTimeSong<116.963){ TweenMax.to("section:nth-child(31)",1,{opacity:1})}
            if(currentTimeSong>116.963 && currentTimeSong<122.419){ TweenMax.to("section:nth-child(32)",1,{opacity:1})}

            if(currentTimeSong>145.333 && currentTimeSong<147.248){ TweenMax.to("section:nth-child(33)",1,{opacity:1})}
            if(currentTimeSong>147.248 && currentTimeSong<148.526){ TweenMax.to("section:nth-child(34)",1,{opacity:1})}
            if(currentTimeSong>148.526 && currentTimeSong<150.093){ TweenMax.to("section:nth-child(35)",1,{opacity:1})}
            if(currentTimeSong>151.997 && currentTimeSong<154.406){ TweenMax.to("section:nth-child(36)",1,{opacity:1})}
            if(currentTimeSong>154.406 && currentTimeSong<156.670){ TweenMax.to("section:nth-child(37)",1,{opacity:1})}
            if(currentTimeSong>157.074 && currentTimeSong<159.193){ TweenMax.to("section:nth-child(38)",1,{opacity:1})}
            if(currentTimeSong>160.723 && currentTimeSong<163.669){ TweenMax.to("section:nth-child(39)",1,{opacity:1})}

            if(currentTimeSong>166.593 && currentTimeSong<168.930){ TweenMax.to("section:nth-child(40)",1,{opacity:1})}
            if(currentTimeSong>171.512 && currentTimeSong<174.734){ TweenMax.to("section:nth-child(41)",1,{opacity:1})}
            if(currentTimeSong>174.734 && currentTimeSong<176.113){ TweenMax.to("section:nth-child(42)",1,{opacity:1})}
            if(currentTimeSong>176.430 && currentTimeSong<180.000){ TweenMax.to("section:nth-child(43)",1,{opacity:1})}
            if(currentTimeSong>180.000 && currentTimeSong<182.329){ TweenMax.to("section:nth-child(44)",1,{opacity:1})}
            if(currentTimeSong>182.459 && currentTimeSong<184.522){ TweenMax.to("section:nth-child(45)",1,{opacity:1})}
            if(currentTimeSong>184.998 && currentTimeSong<187.378){ TweenMax.to("section:nth-child(46)",1,{opacity:1})}
            if(currentTimeSong>187.378 && currentTimeSong<192.225){ TweenMax.to("section:nth-child(47)",1,{opacity:1})}

            if(currentTimeSong>191.979 && currentTimeSong<194.200){ TweenMax.to("section:nth-child(48)",1,{opacity:1})}
            if(currentTimeSong>194.200 && currentTimeSong<197.043){ TweenMax.to("section:nth-child(49)",1,{opacity:1})}
            if(currentTimeSong>197.043 && currentTimeSong<199.119){ TweenMax.to("section:nth-child(50)",1,{opacity:1})}
            if(currentTimeSong>199.119 && currentTimeSong<201.975){ TweenMax.to("section:nth-child(51)",1,{opacity:1})}
            if(currentTimeSong>201.975 && currentTimeSong<203.934){ TweenMax.to("section:nth-child(52)",1,{opacity:1})}
            if(currentTimeSong>203.934 && currentTimeSong<204.893){ TweenMax.to("section:nth-child(53)",1,{opacity:1})}
            if(currentTimeSong>204.893 && currentTimeSong<206.417){ TweenMax.to("section:nth-child(54)",1,{opacity:1})}
            if(currentTimeSong>206.417 && currentTimeSong<207.346){ TweenMax.to("section:nth-child(55)",1,{opacity:1})}
            if(currentTimeSong>207.346 && currentTimeSong<208.797){ TweenMax.to("section:nth-child(56)",1,{opacity:1})}
            if(currentTimeSong>208.797 && currentTimeSong<209.590){ TweenMax.to("section:nth-child(57)",1,{opacity:1})}
            if(currentTimeSong>209.590 && currentTimeSong<211.336){ TweenMax.to("section:nth-child(58)",1,{opacity:1})}

            if(currentTimeSong>211.970 && currentTimeSong<213.874){ TweenMax.to("section:nth-child(59)",1,{opacity:1})}
            if(currentTimeSong>214.305 && currentTimeSong<216.413){ TweenMax.to("section:nth-child(60)",1,{opacity:1})}
            if(currentTimeSong>216.889 && currentTimeSong<218.793){ TweenMax.to("section:nth-child(61)",1,{opacity:1})}
            if(currentTimeSong>219.110 && currentTimeSong<221.014){ TweenMax.to("section:nth-child(62)",1,{opacity:1})}
            if(currentTimeSong>221.014 && currentTimeSong<223.394){ TweenMax.to("section:nth-child(63)",1,{opacity:1})}
            if(currentTimeSong>223.394 && currentTimeSong<225.932){ TweenMax.to("section:nth-child(64)",1,{opacity:1})}
            if(currentTimeSong>225.932 && currentTimeSong<228.590){ TweenMax.to("section:nth-child(65)",1,{opacity:1})}
            if(currentTimeSong>228.590 && currentTimeSong<231.068){ TweenMax.to("section:nth-child(66)",1,{opacity:1})}

            if(currentTimeSong>231.068 && currentTimeSong<233.707){ TweenMax.to("section:nth-child(67)",1,{opacity:1})}
            if(currentTimeSong>233.707 && currentTimeSong<235.928){ TweenMax.to("section:nth-child(68)",1,{opacity:1})}
            if(currentTimeSong>235.928 && currentTimeSong<237.990){ TweenMax.to("section:nth-child(69)",1,{opacity:1})}
            if(currentTimeSong>237.990 && currentTimeSong<241.798){ TweenMax.to("section:nth-child(70)",1,{opacity:1})}
            if(currentTimeSong>243.385 && currentTimeSong<245.606){ TweenMax.to("section:nth-child(71)",1,{opacity:1})}
            if(currentTimeSong>246.082 && currentTimeSong<248.621){ TweenMax.to("section:nth-child(72)",1,{opacity:1})}
            if(currentTimeSong>248.621 && currentTimeSong<251.380){ TweenMax.to("section:nth-child(73)",1,{opacity:1})}

            if(currentTimeSong>251.380 && currentTimeSong<254.967){ TweenMax.to("section:nth-child(74)",1,{opacity:1})}
            if(currentTimeSong>254.967 && currentTimeSong<257.664){ TweenMax.to("section:nth-child(75)",1,{opacity:1})}
            if(currentTimeSong>258.458 && currentTimeSong<263.217){ TweenMax.to("section:nth-child(76)",1,{opacity:1})}

          


            /*
            *
            *
            End
            *
            */
            if(currentTimeSong > 278.141){
                spheresNtoScreen = 0
                currentTimeSong = 279
                TweenMax.to("#outro",3,{opacity:1, transform:"translateY(0vh)"})
                document.getElementById("cache").style.display = "none"
            }



            requestAnimationFrame(game)
        }

        window.addEventListener("resize", resizeCanvas)
        document.addEventListener("mousemove", (e) => {
            mouseX = e.clientX
            mouseY = e.clientY

            centerX = map(mouseX, 0, parseInt(canvas.width),(canvas.width/2)+(canvas.width/4),(canvas.width/2)-(canvas.width/4))
            centerY = map(mouseY, 0, parseInt(canvas.height),(canvas.height/2)+(canvas.height/4),(canvas.height/2)-(canvas.height/4))

            distanceY = map(mouseY - canvas.height/2,0, parseInt(canvas.width),(canvas.width/2)+(canvas.width/4),(canvas.width/2)-(canvas.width/4))
            distanceX = map(mouseX - canvas.width/2,0,parseInt(canvas.height),(canvas.height/2)+(canvas.height/4),(canvas.height/2)-(canvas.height/4))

        })

        document.getElementById("lyrics-fr").style.display = "none"

        function changeLyrics(){
            if (!userClicked){
                userClicked = true
            }
            if(document.getElementById("lyrics-jp").style.display === "none"){
                document.getElementById("lyrics-jp").style.display = ""
                document.getElementById("lyrics-fr").style.display = "none"
            } else {
                document.getElementById("lyrics-jp").style.display = "none"
                document.getElementById("lyrics-fr").style.display = ""
            }
        }




    </script>
</body>

</html>